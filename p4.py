#!/usr/bin/env python
import sys
import re
import unicodecsv as csv
import unidecode
from collections import defaultdict

if __name__ == '__main__':

    # 2014
    # client_ids = [67111,67126,67146,67152,67171,67172,67207,67210,67212,67218,67228,67235,67236,67244,67258,67261,67265,67269,67274,67275,67278,67285,67286,67297,67313,67314,67318,67327,67339,67340,67344,67348,67353,67362,67372,67373,67374,67379,67383,67385,67398,67401,67408,67410,67416,67420,67422,67423,67458,67461,67465,67473,67477,67478,67485,67487,67489,67494,67501,67502,67503,67510,67516,67524,67530,67543,67549,67559,67563,67564,67573,67587,67601,67603,67612,67626,67632,67639,67640,67642,67644,67646,67648,67653,67654,67656,67666,67671,67681,67684,67690,67714,67717,67724,67731,67743,67755,67757,67772,67783,67785,67787,67791,67801,67804,67816,67821,67842,67846,67849,67862,67864,67874,67884,67889,67900,67904,67922,67928,67934,67944,67945,67949,67952,67965,67995,68010,68018,68032,68054,68067,68078,68098,68130,68131,68136,68157,68183,68186,68188,68200,68209,68230,68244,68246,68250,68252,68260,68265,68284,68308,68314,68340,68347,68349,68353,68365,68413,68431,68436,68457,68479,68494,68500,68524,68539,68556,68558,68560,68561,68573,68595,68601,68602,68606,68619,68626,68635,68637,68657,68672,68685,68715,68727,68744,68750,68769,68778,68780,68789,68802,68813,68828,68829,68871,68894,68896,68907,68975,68992,69009,69032,69058,69080,69089,69097,69100,69125,69135,69142,69145,69147,69148,69170,69192,69200,69220,69252,69259,69273,69277,69297,69310,69337,69347,69392,69413,69438,69476,69506,69527,69555,69560,69580,69593,69600,69607,69618,69664,69672,69675,69713,69721,69732,69743,69750,69799,69800,69810,69824,69829,69835,69868,69871,69876,69882,69908,69966,69989,70036,70064,70088,70092,70161,70176,70178,70192,70202,70278,70279,70283,70294,70312,70344,70348,70359,70361,70372,70379,70408,70427,70442,70448,70471,70476,70483,70494,70495,70530,70545,70556,70561,70579,70590,70593,70603,70604,70616,70626,70674,70676,70698,70754,70755,70767,70768,70780,70819,70821,70830,70833,70838,70839,70861,70863,70874,70899,70901,70906,70908,70920,70921,70929,70941,70955,70965,70968,70974,70996,71003,71006,71014,71018,71020,71023,71025,71033,71049,71099,71106,71118,71134,71136,71137,71150,71154,71164,71167,71186,71193,71199,71200,71201,71206,71210,71212,71213,71214,71221,71222,71226,71228,71235,71236,71237,71238,71241,71242,71247,71257,71258,71261,71270,71272,71279,71282,71286,71290,71291,71292,71296,71297,71301,71303,71304,71307,71308,71316,71321,71322,71323,71325,71328,71329,71331,71333,71338,71344,71350,71351,71353,71355,71369,71372,71373,71374,71376,71378,71383,71389,71390,71395,71398,71401,71402,71406,71409,71410,71412,71414,71416,71417,71420,71424,71425,71426,71428,71430,71431,71432,71434,71436,71439,71441,71442,71444,71450,71454,71458,71461,71466,71468,71473,71476,71478,71483,71490,71491,71494,71497,71502,71503,71504,71510,71517,71518,71520,71522,71524,71525,71527,71534,71538,71543,71545,71553,71554,71558,71560,71566,71567,71570,71575,71579,71580,71581,71582,71585,71586,71588,71594,71596,71598,71599,71602,71613,71614,71615,71618,71619,71620,71631,71633,71635,71641,71644,71647,71649,71652,71654,71655,71657,71662,71667,71668,71669,71670,71671,71672,71673,71674,71675,71685,71686,71687,71689,71690,71691,71692,71693,71694,71695,71696,71697,71699,71700,71702,71703,71705,71707,71708,71710,71712,71713,71714,71715,71716,71717,71718,71719,71721,71722,71723,71724,71725,71726,71727,71728,71729,71730,71731,71732,71733,71734,71735,71736,71737,71738,71739,71740,71741,71742,71743,71744,71745,71746,71747,71748,71749,71750,71751,71752,71753,71754,71755,71756,71757,71758,71759,71760,71761,71762,71763,71764,71765,71766,71767,71768,71769,71770,71771,71772,71773,71774,71775,71776,71777,71779,71780,71781,71782,71785]

    # 2015
    # client_ids = [67111,67126,67197,67207,67214,67218,67220,67228,67235,67236,67248,67258,67261,67263,67278,67286,67287,67297,67305,67313,67314,67330,67340,67344,67348,67353,67372,67373,67379,67401,67408,67416,67422,67423,67444,67456,67458,67473,67485,67487,67489,67501,67503,67516,67543,67564,67573,67587,67603,67612,67626,67639,67640,67644,67646,67648,67654,67656,67671,67672,67684,67689,67713,67714,67731,67743,67755,67758,67772,67774,67783,67785,67793,67801,67804,67805,67842,67846,67849,67864,67884,67900,67928,67934,67944,67945,67965,67995,68001,68010,68018,68054,68056,68067,68078,68131,68179,68183,68209,68235,68252,68265,68299,68314,68347,68353,68361,68365,68374,68431,68465,68491,68494,68500,68556,68561,68573,68601,68602,68619,68626,68637,68657,68685,68715,68727,68742,68744,68750,68769,68778,68789,68828,68896,68907,68943,68975,69023,69032,69080,69089,69097,69100,69125,69135,69142,69145,69147,69148,69192,69200,69220,69252,69259,69273,69277,69297,69310,69337,69347,69383,69392,69476,69527,69555,69580,69600,69607,69618,69664,69689,69713,69721,69732,69743,69750,69799,69800,69824,69829,69868,69871,69876,69882,69966,69989,70036,70064,70088,70161,70178,70192,70278,70279,70283,70294,70312,70344,70348,70359,70361,70372,70379,70408,70427,70442,70448,70471,70476,70483,70494,70495,70530,70545,70556,70561,70579,70590,70593,70603,70604,70616,70626,70676,70698,70755,70780,70819,70821,70830,70833,70838,70839,70861,70863,70870,70899,70901,70908,70920,70929,70941,70965,70968,70996,71006,71007,71018,71020,71023,71025,71033,71044,71049,71080,71099,71106,71118,71134,71137,71146,71164,71167,71179,71186,71193,71194,71199,71201,71206,71210,71213,71214,71222,71226,71235,71236,71238,71241,71242,71247,71257,71258,71261,71270,71278,71279,71282,71286,71290,71291,71292,71296,71297,71300,71304,71316,71321,71322,71323,71328,71329,71331,71333,71351,71355,71368,71369,71372,71373,71374,71378,71383,71389,71390,71398,71401,71409,71412,71417,71420,71425,71428,71430,71431,71434,71436,71442,71444,71450,71454,71468,71473,71476,71483,71486,71490,71491,71497,71503,71504,71510,71520,71527,71534,71538,71543,71545,71553,71558,71560,71566,71567,71570,71579,71580,71581,71585,71594,71596,71597,71598,71599,71613,71615,71618,71631,71633,71641,71649,71651,71654,71657,71662,71666,71668,71673,71674,71675,71676,71685,71687,71689,71690,71696,71697,71699,71702,71704,71707,71708,71710,71712,71714,71715,71719,71721,71727,71728,71730,71732,71733,71734,71742,71747,71748,71752,71754,71763,71764,71768,71769,71771,71772,71773,71775,71776,71777,71780,71783,71784,71786,71787,71788,71789,71790,71791,71792,71794,71796,71797,71798,71800,71801,71803,71804,71805]
    
    with open(sys.argv[1], 'r') as csvfile:
        reader = csv.DictReader(csvfile, delimiter=',', quotechar='"')
        records = [r for r in reader]

    campos_nombres = {"CAMPNG":"CAMP",
                      "PESCA.1":"PESP",
                      "OPTICA.1":"OPTI",
                      "PESCA.CA.AS":"PESC",
                      "PESCA.REELS.1":"PESR",
                      "INDU":"INDU",
                      "INDU.Y.PESCA":"INDP",
                      "TIRO.Y.DEF":"TIRO",
                      "CUCHILL":"CUCH",
                      "INSTRU":"INST"}

    field_names = ["CAMPNG","PESCA.1","OPTICA.1","PESCA.CA.AS","PESCA.REELS.1","INDU","INDU.Y.PESCA","TIRO.Y.DEF","CUCHILL","INSTRU"]
    NA = ''
    campos = {"CAMP":NA, "PESP":NA, "OPTI":NA, "PESC":NA, "PESR":NA, "INDU":NA, "INDP":NA, "TIRO":NA, "CUCH":NA, "INST":NA}

    agrupado = defaultdict(list)
    for r in records:
        agrupado[r['cliente']].append(r['monto_por_categoria'])

    print('cliente,%s' % ','.join(field_names))
    for cliente in client_ids:
        valores = set(agrupado[str(cliente)])
        categorias = campos.copy()
        for valor in valores: categorias[valor[0:4]] = valor

        output = [str(cliente)]
        output.extend(['"%s"' % categorias[campos_nombres[field_name]] for field_name in field_names])
        print(','.join(output))
